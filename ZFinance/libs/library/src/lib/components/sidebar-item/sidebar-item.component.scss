/* @use 'tailwindcss'; */

@mixin expanded {
    li {
        > div {
            &.parent {
                &:not(.loading):after {
                    @apply opacity-100;
                }

                a {
                    @apply pr-8;
                }

                &.loading .loading {
                    @apply opacity-100 #{!important};
                }
            }

            a {
                i {
                    @apply text-lg ml-0;
                }

                span {
                    @apply opacity-100;
                }
            }
        }
    }
}

:host {
    @apply block relative;

    @media (max-width: 767px) {
        &:not(.active) li > ul {
            @apply h-0 #{!important};
        }
    } 

    @screen md {
        &:not(.expanded):not(.active) li > ul {
            @apply h-0 #{!important};
        }

        &.expanded {
            @include expanded;
        }
    }

    &.active {
        @include expanded;
    }

    &.expanded, &.active {
        li .selected:not(.loading).parent:after {
            @apply -rotate-90;
        }
    }

    &.first-level {
        &:before {
            @apply content-[''] absolute top-0 left-0 bottom-0 w-0 bg-gray-100 z-10;
            @apply transition-[width] ease-in-out;
            transition-duration: var(--sidebar-animation-duration);
            will-change: width;
        }

        &.selected:before {
            @apply w-[4px];
        }
    }
}

li {
    @apply relative h-full;

    > div {
        @apply relative overflow-hidden;
        height: var(--sidebar-item-height);
        line-height: var(--sidebar-item-height);

        &:hover {
            @apply bg-slate-700;
        }

        &.parent:after {
            @apply absolute font-extrabold w-[10px] top-0 right-3;
            @apply transition-[opacity] ease-in-out;
            @apply opacity-0;
            font-family: "Font Awesome 6 Free";
            transition-duration: var(--sidebar-animation-duration);
            will-change: opacity;

            &:not(.failed) {
                @apply content-['\f104'];
            }

            &.failed {
                @apply right-4 content-['\f071'];
            }
        }

        a {
            @apply block h-full px-3 text-left whitespace-nowrap cursor-pointer overflow-hidden text-ellipsis;
            width: var(--sidebar-expanded-width);

            i {
                @apply text-xl mr-2;
                @apply transition-[font-size,line-height,margin-left] ease-in-out;
                margin-left: var(--sidebar-icon-collapsed-margin);
                transition-duration: var(--sidebar-animation-duration);
                will-change: font-size, line-height, margin-left;
            }

            span {
                @apply opacity-0 text-ellipsis;
                @apply transition-[opacity] ease-in-out;
                transition-duration: var(--sidebar-animation-duration);
                will-change: opacity;
            }
        }

        .loading {
            @apply absolute w-4 h-full top-0 right-[0.55rem] opacity-0;
            @apply transition-[opacity] ease-in-out;
            transition-duration: var(--sidebar-animation-duration);
            will-change: opacity;

            svg {
                @apply w-full h-full;
            }
        }
    }

    > ul {
        @apply overflow-hidden;
        @apply transition-[height,max-height] ease-in-out;
        transition-duration: var(--sidebar-animation-duration);
        will-change: height, max-height;

        a {
            @apply pl-5;
        }
    }
}